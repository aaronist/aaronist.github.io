<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="We&amp;rsquo;ve all received those messages.
WINNER!! As a valued network customer you have been selected to receivea £900 prize reward! To claim call 09061701461. Claim code KL341. Valid 12 hours only.
500 New Mobiles from 2021, MUST GO! Txt: NOKIA to No: 89545 &amp;amp; collect yours today!From ONLY £1 2optout 087187262701.50gbp/mtmsg18 TXTAUCTION
These intentionally misleading messages, commonly referred to as &amp;ldquo;spam&amp;rdquo;, are much more prolific in today&amp;rsquo;s world given the universality and convenience of SMS." />
<meta name="keywords" content=", machine learning, hmm, spam detection, algorithms" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://aaronist.github.io/posts/sms-spam-detection/" />


    <title>
        
            Discrete Hidden Markov Model for SMS Spam Detection :: Aaron Blume&#39;s Portfolio 
        
    </title>





<link rel="stylesheet" href="/main.949191c1dcc9c4a887997048b240354e47152016d821198f89448496ba42e491.css" integrity="sha256-lJGRwdzJxKiHmXBIskA1TkcVIBbYIRmPiUSElrpC5JE=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Discrete Hidden Markov Model for SMS Spam Detection">
  <meta itemprop="description" content="We’ve all received those messages.
WINNER!! As a valued network customer you have been selected to receivea £900 prize reward! To claim call 09061701461. Claim code KL341. Valid 12 hours only.
500 New Mobiles from 2021, MUST GO! Txt: NOKIA to No: 89545 &amp; collect yours today!From ONLY £1 2optout 087187262701.50gbp/mtmsg18 TXTAUCTION
These intentionally misleading messages, commonly referred to as “spam”, are much more prolific in today’s world given the universality and convenience of SMS.">
  <meta itemprop="datePublished" content="2024-06-06T14:57:58-07:00">
  <meta itemprop="dateModified" content="2024-06-06T14:57:58-07:00">
  <meta itemprop="wordCount" content="747">
  <meta itemprop="keywords" content="Machine Learning,Hmm,Spam Detection,Algorithms">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Discrete Hidden Markov Model for SMS Spam Detection">
  <meta name="twitter:description" content="We’ve all received those messages.
WINNER!! As a valued network customer you have been selected to receivea £900 prize reward! To claim call 09061701461. Claim code KL341. Valid 12 hours only.
500 New Mobiles from 2021, MUST GO! Txt: NOKIA to No: 89545 &amp; collect yours today!From ONLY £1 2optout 087187262701.50gbp/mtmsg18 TXTAUCTION
These intentionally misleading messages, commonly referred to as “spam”, are much more prolific in today’s world given the universality and convenience of SMS.">







    <meta property="article:published_time" content="2024-06-06 14:57:58 -0700 PDT" />












        
            <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>
        
    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                hello</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/posts">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://aaronist.github.io/posts/sms-spam-detection/">Discrete Hidden Markov Model for SMS Spam Detection</a>
      </h1>

      

      

      

      <div class="post-content">
        <p>We&rsquo;ve all received those messages.</p>
<blockquote>
<p><em>WINNER!! As a valued network customer you have been selected to receivea £900 prize reward! To claim call 09061701461. Claim code KL341. Valid 12 hours only.</em></p>
</blockquote>
<blockquote>
<p><em>500 New Mobiles from 2021, MUST GO! Txt: NOKIA to No: 89545 &amp; collect yours today!From ONLY £1 2optout 087187262701.50gbp/mtmsg18 TXTAUCTION</em></p>
</blockquote>
<p>These intentionally misleading messages, commonly referred to as &ldquo;spam&rdquo;, are much more prolific in today&rsquo;s world given the universality and convenience of SMS. Luckily for us, machine learning is also rapidly growing, and it can serve as a great mechanism for automatically filtering spam messages. In fact, there has already been extensive research done on this topic, and I would highly recommend taking a look at the machine learning models that others have deployed in order to tackle this problem. For example, check out the <a href="(https://arxiv.org/abs/2202.03480)">transfer learning technique used by Vijay Tida and Sonya Hsu</a> as well as the <a href="https://arxiv.org/abs/2304.01238">LLM used by Maxime Labonne and Sean Moran</a>.</p>
<h2 id="naïve-bayes">Naïve Bayes</h2>
<p>Bayesian models are a popular way of representing spam classification tasks. We can declare a binary indicator \(Y\) which identifies whether or not a message is spam and a variable \(x_i\) which represents the \(i\)-th word in a message. We can construct a naïve Bayes model by using the bag-of-words model and computing the probabilities of observing a word conditioned on the message&rsquo;s classification. For two arbitrary words, an example distribution might be something like:</p>
\[
\begin{aligned}
\hat{p}(\text{winner} | Y = 1) = 0.00923 \\
\hat{p}(\text{winner} | Y = 0) = 0.00039
\end{aligned}
\]
\[
\begin{aligned}
\hat{p}(\text{sometimes} | Y = 1) = 0.00007 \\
\hat{p}(\text{sometimes} | Y = 0) = 0.00298
\end{aligned}
\]
<p>The probability of observing a spammy word like &ldquo;winner&rdquo; is much more likely to show up in spam messages than ham (i.e. non-spam) messages. On the other hand, non-spammy words like &ldquo;sometimes&rdquo; are rarely going to be observed in spam messages and are more likely to appear in ham messages. Using this, we can compute a word&rsquo;s score as the log-odds ratio of its probabilities</p>
\[
\begin{aligned}
\eta_i = \log\frac{p(x_i | Y = 1)}{p(x_i | Y = 0)}
\end{aligned}
\]
<p>and sum together the scores of each individual word in the message. The cumulative score of a message classifies it as spam or ham based on some threshold value (typically 0 with positive scores indicating spam and negative scores indicating ham).</p>
<p>Of course, you may have noticed that this is a very simple model and forces us to assume that each feature is conditionally independent given \(Y\). Each word is treated as an independent observation given the classification of the message being spam or ham. By then applying Bayes&rsquo; rule, we simply accumulate a preference for either category. More generally, we&rsquo;re marginalizing over \(Y\) by adding together the probabilities of what happens when \(Y\) is true (i.e. the product of \(Y = 1\) multiplied against the product of the individual conditional distributions) and when \(Y\) is false.</p>
\[
\begin{aligned}
p(Y = 1 | x) = \frac{p(Y = 1) \prod_i p(x_i | Y = 1)}{p(Y = 1) \prod_i p(x_i | Y = 1) + p(Y = 0) \prod_i p(x_i | Y = 0)}
\end{aligned}
\]
<h2 id="hidden-markov-model">Hidden Markov Model</h2>
<p>The simplicity of the naïve Bayes model is nice, but we can take this a step further by introducing the Markov assumption: that the future state depends solely on the current state. One of the defining features of a hidden Markov model (HMM) is that it&rsquo;s a memoryless stochastic process. This means that we can easily compute future probabilities in a dynamic fashion without needing to retain all of the preceding states of the model.</p>
<p>Before continuing any further, I want to give credit to Tian Xia and Xuemin Chen for <a href="https://doi.org/10.3390/app10145011">their research in using HMMs for spam detection</a>. Much of what I completed is based on their research.</p>
<h3 id="preprocessing">Preprocessing</h3>
<p>Before we start training any sort of HMM, it&rsquo;s important to get our data in a proper format. For my data, I used the <a href="https://archive.ics.uci.edu/dataset/228/sms+spam+collection">SMS Spam Collection</a> dataset, collected by Tiago Almeida and Jos Hidalgo, which is hosted in the UCI Machine Learning Repository.</p>
<h2 id="references">References</h2>
<p>[1] M. Labonne, S. Moran. &ldquo;<a href="https://arxiv.org/abs/2304.01238">Spam-T5: Benchmarking Large Language Models for Few-Shot Email Spam Detection</a>&rdquo;. 2023.</p>
<p>[2] T. Almeida, J. Hidalgo. &ldquo;<a href="https://doi.org/10.24432/C5CC84">SMS Spam Collection</a>&rdquo;. <em>UCI Machine Learning Repository</em>. 2012.</p>
<p>[3] T. Xia, X. Chen. &ldquo;<a href="https://doi.org/10.3390/app10145011">A Discrete Hidden Markov Model for SMS Spam Detection</a>&rdquo;. <em>Appl. Sci.</em> 2020.</p>
<p>[4] V. Tida, S. Hsu. &ldquo;<a href="https://arxiv.org/abs/2202.03480">Universal Spam Detection using Transfer Learning of BERT Model</a>&rdquo;. 2022.</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://aaronist.github.io/tags/machine-learning/">machine learning</a></span>
        <span class="tag"><a href="https://aaronist.github.io/tags/hmm/">hmm</a></span>
        <span class="tag"><a href="https://aaronist.github.io/tags/spam-detection/">spam detection</a></span>
        <span class="tag"><a href="https://aaronist.github.io/tags/algorithms/">algorithms</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        747 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2024-06-06 14:57
        

         
          
        
      </p>
    </div>

    

    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            
            <span>&copy 2024 <a href="https://aaronist.github.io/">Aaron Blume</a> | Powered by <a href="https://gohugo.io/">Hugo</a></span>
            
            
        </div>
    </div>
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.85fad2de4f13fec3bcb3b3cb10430cdb44a7b4a9749b32938241a5c6e77718df7624f1002b880521fdc26e24ec1077fda214bf1cb36ee3045510760d09638cae.js" integrity="sha512-hfrS3k8T/sO8s7PLEEMM20SntKl0mzKTgkGlxud3GN92JPEAK4gFIf3CbiTsEHf9ohS/HLNu4wRVEHYNCWOMrg=="></script>




    </body>
</html>
